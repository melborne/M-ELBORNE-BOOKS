<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="ja">
  <head>
    <title>知って得する！５５のRubyのトリビアな記法</title>
    <link href='css/style.css' rel='stylesheet' type='text/css'/>
<link href='css/syntax.css' rel='stylesheet' type='text/css'/>
  </head>
  <body>
<h2>45. Enumerable#grep</h2>

<p>caseにおける同値判定は再定義可能な<code>===</code>でされます。</p>

<div class="highlight"><pre><code class="ruby"><span class="n">temp</span> <span class="o">=</span> <span class="mi">85</span>
<span class="n">status</span> <span class="o">=</span>
  <span class="k">case</span> <span class="n">temp</span>
  <span class="k">when</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">40</span><span class="p">;</span>   <span class="ss">:low</span>
  <span class="k">when</span> <span class="mi">80</span><span class="o">.</span><span class="n">.</span><span class="mi">100</span><span class="p">;</span> <span class="ss">:Danger</span>
  <span class="k">else</span> <span class="ss">:ok</span>
  <span class="k">end</span>
<span class="n">status</span> <span class="c1"># =&gt; :Danger</span>

<span class="k">class</span> <span class="nc">Trivia</span>
<span class="k">end</span>
<span class="n">t</span> <span class="o">=</span> <span class="no">Trivia</span><span class="o">.</span><span class="n">new</span>

<span class="n">klass</span> <span class="o">=</span>
  <span class="k">case</span> <span class="n">t</span>
  <span class="k">when</span> <span class="nb">String</span><span class="p">;</span> <span class="s1">&#39;no good&#39;</span>
  <span class="k">when</span> <span class="nb">Array</span><span class="p">;</span>  <span class="s1">&#39;no no&#39;</span>
  <span class="k">when</span> <span class="no">Trivia</span><span class="p">;</span> <span class="s1">&#39;Yes! Trivia!&#39;</span>
  <span class="k">end</span>
<span class="n">klass</span> <span class="c1"># =&gt; &quot;Yes! Trivia!&quot;</span>
</code></pre></div>


<p>例は<code>Range#===</code>と<code>Module#===</code>による判定です。</p>

<p>実は<code>Enumerable#grep</code>におけるパターンマッチも===で判定されるのです。</p>

<div class="highlight"><pre><code class="ruby"><span class="n">numbers</span> <span class="o">=</span> <span class="mi">5</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span> <span class="c1"># =&gt; [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80]</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="mi">20</span><span class="o">.</span><span class="n">.</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># =&gt; [20, 25, 30, 35, 40, 45, 50]</span>

<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">t4</span><span class="p">,</span> <span class="n">t5</span> <span class="o">=</span> <span class="s1">&#39;trivia&#39;</span><span class="p">,</span> <span class="no">Trivia</span><span class="o">.</span><span class="n">new</span><span class="p">,</span> <span class="o">[</span><span class="ss">:trivia</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="ss">trivia</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="no">Trivia</span><span class="o">.</span><span class="n">new</span>

<span class="o">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">t4</span><span class="p">,</span> <span class="n">t5</span><span class="o">].</span><span class="n">grep</span><span class="p">(</span><span class="no">Trivia</span><span class="p">)</span> <span class="c1"># =&gt; [#&lt;Trivia:0x000001008613b0&gt;, #&lt;Trivia:0x000001008610e0&gt;]</span>
</code></pre></div>



  </body>
</html>
