<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="ja">
  <head>
    <title>オブジェクトの理解から始めるRuby</title>
    <link href='css/style.css' rel='stylesheet' type='text/css'/>
<link href='css/syntax.css' rel='stylesheet' type='text/css'/>
  </head>
  <body>
<h2>７章　Singletonメソッド（抽象メソッド）</h2>

<p>オブジェクトの中身はほとんど空であるということを書きました。しかしオブジェクトはクラスやモジュールと同様に、その内部にselfメソッドを持つことができます。オブジェクトにおけるselfメソッドは、「Singletonメソッド」または「抽象メソッド」などと呼ばれています。</p>

<p>Singletonメソッドは、そのオブジェクト固有のメソッドを定義するために使われます。</p>

<div class="highlight"><pre><code class="ruby"><span class="n">a_friend</span> <span class="o">=</span> <span class="no">PersonInEarth</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;Fernand&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="s2">&quot;Spain&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nc">a_friend</span><span class="o">.</span><span class="nf">name</span>
  <span class="s2">&quot;My friend, </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">end</span>

<span class="n">a_friend</span><span class="o">.</span><span class="n">name</span> <span class="c1"># =&gt; &quot;My friend, Fernando&quot;</span>
</code></pre></div>


<p>メソッド定義におけるメソッド名の前にオブジェクトを置くことによって、そのオブジェクトのSingletonメソッドが定義できます。Singletonメソッドはクラスツリーの最下層に位置し、メソッド探索において最優先の探索先となります。</p>

<p>正確に記せばSingletonメソッドは、そのオブジェクト自身に定義されているのではなく、そのオブジェクトとそのクラスとの間に生成される、<strong>無名のクラス</strong>に定義されます。したがってこの無名クラスにSingletonメソッドを定義しても同様の結果が得られます。</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="n">a_friend</span>
  <span class="k">def</span> <span class="nf">name</span>
    <span class="s2">&quot;My friend, </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">a_friend</span><span class="o">.</span><span class="n">name</span> <span class="c1"># =&gt; &quot;My friend, Fernando&quot;</span>
</code></pre></div>


<p>class名を無名とし、オブジェクト名を二重の接ぎ木記号で繋ぎます（感情的には接ぎ木の向きは逆ですが）。複数のSingletonメソッドをまとめて定義する場合、この書式が有用です。この無名クラスは「Singletonクラス」とも呼ばれます。</p>

<p><img src="images/ruby_singleton.png" alt="Alt title noshadow" /></p>

<br clear='all' />


<p>Singletonクラスはクラスメソッドやモジュールメソッドを定義する場合にも使えます。</p>
  </body>
</html>
